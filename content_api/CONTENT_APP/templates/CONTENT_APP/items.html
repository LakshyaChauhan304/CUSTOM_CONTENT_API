{% extends "CONTENT_APP/base.html" %}
{% block content %}
<h2>Content Items</h2>
<div id="itemsContainer">Loading items…</div>

<h2>Wagtail Demo Pages</h2>
<div id="demoPagesContainer">Loading demo pages…</div>

<script>
async function loadItems() {
  const res = await fetch('/content/api/items/');
  const data = await res.json();
  const container = document.getElementById('itemsContainer');

  const items = Array.isArray(data) ? data : (data.results || []);

  if (!items.length) {
    container.innerHTML = '<p>No items yet.</p>';
    return;
  }

  container.innerHTML = items.map(item => `
    <div class="card">
      <h3>${item.title}</h3>
      <p>${item.body || ''}</p>
      <small>id: ${item.id}</small>
    </div>
  `).join('');
}

async function loadDemoPages() {
  const res = await fetch('/api/v2/pages/?type=CONTENT_APP.DemoPage&fields=title,subtitle,body');
  const data = await res.json();
  const pages = data.items || [];
  const container = document.getElementById('demoPagesContainer');

  if (!pages.length) {
    container.innerHTML = '<p>No DemoPages published yet.</p>';
    return;
  }

  container.innerHTML = pages.map(page => `
    <div class="card">
      <h3>${page.title}</h3>
      <h4>${page.subtitle || ''}</h4>
      <div>${page.body || ''}</div>
      <small>id: ${page.id}</small>
    </div>
  `).join('');
}

loadItems();
loadDemoPages();
</script>
{% endblock %}
